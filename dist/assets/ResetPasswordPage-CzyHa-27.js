import{r,k as B,p as N,j as e,B as a,T as o,l as E}from"./index-TH8YGKRz.js";import{V as y,a as P}from"./Visibility-B8j3ksI8.js";import{T as C}from"./TextField-Du34Z7EL.js";import{I as W}from"./InputAdornment-Cgg0GFqY.js";import{I as v}from"./IconButton-BAp8iDOQ.js";import{B as m}from"./Button-CJZqiG46.js";import{D as L,a as V,b as F,c as M}from"./DialogTitle-CKHsR478.js";import"./createSvgIcon-B0Pm_6cI.js";import"./createSvgIcon-1GfyKPJS.js";import"./useControlled-BLQOo7Av.js";import"./resolveComponentProps-CAz9EWAT.js";import"./Menu-CzX3FVwN.js";import"./Paper-Mdtt8qvf.js";const A=[{label:"At least one capital letter",test:t=>/[A-Z]/.test(t)},{label:"At least one lowercase letter",test:t=>/[a-z]/.test(t)},{label:"At least one number",test:t=>/\d/.test(t)},{label:"Minimum character length is 8 characters",test:t=>t.length>=8}],Y=()=>{const[t,l]=r.useState(""),[n,D]=r.useState(""),[p,R]=r.useState(!1),[f,I]=r.useState(!1),[i,d]=r.useState(""),[u,c]=r.useState(!1),[k,x]=r.useState(!1),z=B(),[T]=N(),g=T.get("token"),b=A.every(s=>s.test(t)),h=b&&t===n&&t.length>0&&!u&&!!g,O=async()=>{d(""),c(!0);try{const S=await(await fetch("http://localhost:3000/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:g,password:t,newPassword:n})})).json();if(!S.success){d(S.message||"Failed to reset password."),c(!1);return}x(!0)}catch{d("Something went wrong. Please try again.")}finally{c(!1)}},w=()=>{x(!1),z("/login")};return e.jsx(a,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#fff",justifyContent:"center",alignItems:"flex-start",pt:10},children:e.jsxs(a,{sx:{width:"100%",maxWidth:420,px:1,py:2,boxShadow:0,borderRadius:3,mx:"auto"},children:[e.jsx(o,{variant:"h4",sx:{fontWeight:800,mb:2,color:"#222"},children:"New password"}),e.jsx(o,{sx:{color:"#6b7280",fontWeight:500,fontSize:18,mb:2},children:"Enter a new password for your account"}),e.jsx(o,{sx:{fontWeight:700,fontSize:16,mb:.5,color:"#222"},children:"New Password"}),e.jsx(C,{fullWidth:!0,placeholder:"Your new password",variant:"outlined",type:p?"text":"password",value:t,onChange:s=>l(s.target.value),sx:{mb:1.5,borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2}},InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(v,{onClick:()=>R(s=>!s),edge:"end",children:p?e.jsx(y,{}):e.jsx(P,{})})})},error:!!i&&!b}),e.jsx(o,{sx:{fontWeight:700,fontSize:16,mb:.5,color:"#222"},children:"Confirm New Password"}),e.jsx(C,{fullWidth:!0,placeholder:"Confirm your new password",variant:"outlined",type:f?"text":"password",value:n,onChange:s=>D(s.target.value),sx:{mb:1.5,borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2}},InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(v,{onClick:()=>I(s=>!s),edge:"end",children:f?e.jsx(y,{}):e.jsx(P,{})})})},error:!!i&&t!==n}),e.jsx(o,{sx:{fontWeight:700,fontSize:16,mb:.5,color:"#222"},children:"Your password must contain"}),e.jsx(a,{component:"ul",sx:{pl:0,mb:2,listStyle:"none"},children:A.map((s,j)=>e.jsxs(a,{component:"li",sx:{display:"flex",alignItems:"center",mb:.2,color:s.test(t)?"#2950DA":"#6b7280",fontSize:15,fontWeight:s.test(t)?700:400},children:[e.jsx("span",{style:{color:s.test(t)?"#2950DA":"#bdbdbd",fontWeight:700,fontSize:18,marginRight:8},children:"âœ”"})," ",s.label]},j))}),e.jsx(m,{variant:"contained",fullWidth:!0,sx:{bgcolor:h?"#2950DA":"#bdbdbd",color:"#fff",fontWeight:700,fontSize:20,borderRadius:2,py:1.2,mb:2,boxShadow:"none",textTransform:"none","&:hover":{bgcolor:h?"#526794":"#bdbdbd"}},onClick:O,disabled:!h,children:u?"Setting...":"Set new password"}),i&&e.jsx(o,{sx:{color:"red",textAlign:"center",mb:1},children:i}),e.jsxs(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{color:"#6b7280",fontWeight:500,fontSize:16},children:"Back to"}),e.jsx(m,{href:"/login",sx:{color:"#2950DA",fontWeight:700,fontSize:16,textTransform:"none",p:0,minWidth:0},children:"Login"})]}),e.jsxs(L,{open:k,onClose:w,children:[e.jsx(V,{children:"Password Reset Successful"}),e.jsx(F,{children:e.jsx(o,{children:"Your password has been reset successfully."})}),e.jsx(M,{children:e.jsx(m,{onClick:w,variant:"contained",color:"primary",children:"Login"})})]})]})})},se=()=>{var n;const l=((n=E().state)==null?void 0:n.email)||"";return e.jsx(Y,{email:l})};export{se as default};
