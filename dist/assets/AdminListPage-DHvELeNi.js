import{r as i,R as q,j as e,B as n,T as o,n as G}from"./index-TH8YGKRz.js";import{S as K}from"./Search-DrB_le8H.js";import{T as Q,a as Z,b as $,c as p,d as t,e as ee,C as se,f as te,P as ae}from"./CheckBoxOutlineBlank-BWvBqfBb.js";import{M as ie}from"./MoreVert-DIEecuZq.js";import{A as k,D as re}from"./AdminSidebar-Bc6icHTo.js";import{s as E,c as g,t as f}from"./tokens-DkKdY8jA.js";import{g as v,a as ne,c as W}from"./workspaceService-BQTsMTjt.js";import{T as oe}from"./TextField-Du34Z7EL.js";import{I as le}from"./InputAdornment-Cgg0GFqY.js";import{P as ce}from"./Paper-Mdtt8qvf.js";import{C as de}from"./Checkbox-Ck6fmr8t.js";import{I as xe}from"./IconButton-BAp8iDOQ.js";import{D as he,a as me,b as pe,c as fe}from"./DialogTitle-CKHsR478.js";import{B as S}from"./Button-CJZqiG46.js";import"./createSvgIcon-B0Pm_6cI.js";import"./createSvgIcon-1GfyKPJS.js";import"./useControlled-BLQOo7Av.js";import"./Menu-CzX3FVwN.js";import"./resolveComponentProps-CAz9EWAT.js";import"./Divider-7QTrz6EV.js";import"./getThemeProps-DA88l0eV.js";import"./Avatar-BgeWc8dC.js";import"./useSlot-B20WKvL2.js";import"./SwitchBase-GCTxqK2a.js";const Le=()=>{const[c,z]=i.useState(""),[P,U]=i.useState([]),[j,R]=i.useState(1),[b,B]=i.useState([]),[M,y]=i.useState(!0),[w,C]=i.useState(""),[r,d]=i.useState(null),[O,x]=i.useState(!1),[l,F]=i.useState(""),[u,L]=i.useState(0),N=async s=>{try{if(!l)throw new Error("Workspace not loaded");await W(l,s,"ACTIVE"),await h(),x(!1),d(null)}catch{alert("Failed to activate user.")}},V=async s=>{try{if(!l)throw new Error("Workspace not loaded");await W(l,s,"DEACTIVATED"),await h(),x(!1),d(null)}catch{alert("Failed to deactivate user.")}},h=async()=>{y(!0),C("");try{if(!l){const m=await v();F(m.id)}const s=l||(await v()).id,a=await ne(s,{role:"ADMIN",page:j,limit:10,search:c||void 0});B(a.data),L(a.pagination.total)}catch{C("Failed to load admin users")}finally{y(!1)}};i.useEffect(()=>{h();const s=setInterval(h,3e4);return()=>clearInterval(s)},[]),i.useEffect(()=>{h()},[j,c]);const H=s=>{U(a=>a.includes(s)?a.filter(m=>m!==s):[...a,s])},J=async s=>{try{const a=b.find(m=>m.id===s);if(a)d(a),x(!0);else throw new Error("User not found")}catch{d(null),x(!1),alert("Failed to load user details")}},I=()=>{x(!1),d(null)},A=()=>{G()},X=b.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),D=10,T=X,[Y,_]=q.useState(!1);return e.jsxs(n,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f7f8fa"},children:[e.jsx(n,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(k,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:A})}),e.jsx(re,{open:Y,onClose:()=>_(!1),PaperProps:{sx:{width:240}},children:e.jsx(k,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:A,isDrawer:!0})}),e.jsxs(n,{sx:{flex:1,display:"flex",flexDirection:"column",ml:{xs:0,md:"220px"},minWidth:0,px:E.pagePx,py:E.pagePy},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,pt:{xs:2,md:3},fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif'},children:[e.jsx(n,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:e.jsxs(n,{children:[e.jsx(o,{sx:{fontWeight:f.title.weight,fontSize:{xs:f.title.xs,md:f.title.md},color:g.textPrimary},children:"Admin Users"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(n,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:g.primary,opacity:.7}}),e.jsxs(o,{sx:{color:g.textSecondary,fontSize:f.caption.size},children:[u," admins"]})]})]})}),e.jsx(oe,{placeholder:"Search admin users...",size:"small",InputProps:{startAdornment:e.jsx(le,{position:"start",children:e.jsx(K,{sx:{color:"#bdbdbd"}})}),sx:{borderRadius:3,bgcolor:"#fff",width:{xs:220,sm:320},fontSize:16}},value:c,onChange:s=>z(s.target.value)})]}),e.jsxs(ce,{elevation:0,sx:{borderRadius:3,p:{xs:2,md:3}},children:[e.jsx(Q,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(Z,{size:"small",children:[e.jsx($,{children:e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User ID"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Name"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Type"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"Status"}),e.jsx(t,{align:"right"})]})}),e.jsx(ee,{children:M?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(o,{children:"Loading admin users..."})})}):w?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4,color:"error.main"},children:e.jsx(o,{children:w})})}):T.length===0?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(o,{children:"No admin users found"})})}):T.map((s,a)=>e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox",children:e.jsx(de,{checked:P.includes(a),onChange:()=>H(a),icon:e.jsx(te,{}),checkedIcon:e.jsx(se,{sx:{color:"#2950DA"}})})}),e.jsx(t,{sx:{fontWeight:700,fontSize:{xs:12,md:16},whiteSpace:"nowrap"},children:s.id}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.name}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.role}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.status==="ACTIVE"?"Active":"Inactive"}),e.jsx(t,{align:"right",children:e.jsx(xe,{onClick:()=>J(s.id),children:e.jsx(ie,{})})})]},s.id))})]})}),u>D&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:e.jsx(ae,{count:Math.ceil((u||0)/D),page:j,onChange:(s,a)=>R(a),color:"primary",shape:"rounded",size:"large"})})]})]}),e.jsxs(he,{open:O,onClose:I,maxWidth:"sm",fullWidth:!0,children:[e.jsx(me,{children:"User Details"}),e.jsx(pe,{children:r?e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx("b",{children:"ID:"})," ",r.id]}),e.jsxs(o,{children:[e.jsx("b",{children:"Name:"})," ",r.name]}),e.jsxs(o,{children:[e.jsx("b",{children:"Email:"})," ",r.email]}),e.jsxs(o,{children:[e.jsx("b",{children:"User Type:"})," ",r.role]}),e.jsxs(o,{children:[e.jsx("b",{children:"Active:"})," ",r.status==="ACTIVE"?"Yes":"No"]})]}):null}),e.jsxs(fe,{children:[e.jsx(S,{onClick:I,children:"Close"}),r&&e.jsx(e.Fragment,{children:r.status==="ACTIVE"?e.jsx(S,{onClick:()=>V(r.id),color:"warning",children:"Deactivate"}):e.jsx(S,{onClick:()=>N(r.id),color:"success",children:"Activate"})})]})]})]})};export{Le as default};
