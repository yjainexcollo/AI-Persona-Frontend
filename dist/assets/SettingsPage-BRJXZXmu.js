import{a as Re,g as Ee,r as i,u as We,_ as De,b as B,j as e,s as q,c as Ne,d as S,e as Ie,z as F,f as ee,h as se,i as te,F as O,B as o,n as ce,T as r,C as Me}from"./index-TH8YGKRz.js";import{A as de,D as Te,M as ue,a as _e,W as Fe}from"./AdminSidebar-Bc6icHTo.js";import{r as ae}from"./createSvgIcon-B0Pm_6cI.js";import{s as pe,t as Y,c as Oe}from"./tokens-DkKdY8jA.js";import{g as Be,u as qe}from"./workspaceService-BQTsMTjt.js";import{B as j}from"./Button-CJZqiG46.js";import{P as Q}from"./Paper-Mdtt8qvf.js";import{S as Le}from"./SwitchBase-GCTxqK2a.js";import{D as he,a as xe,b as fe,c as ge}from"./DialogTitle-CKHsR478.js";import{T as $,F as me,a as be,S as we}from"./TextField-Du34Z7EL.js";import{A as Ue}from"./Alert-DkG2QiTi.js";import{G as A}from"./Grid-M9g4rATc.js";function He(s){return Ee("MuiSwitch",s)}const d=Re("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Ge=["className","color","edge","size","sx"],Je=s=>{const{classes:a,edge:n,size:g,color:k,checked:u,disabled:v}=s,C={root:["root",n&&`edge${S(n)}`,`size${S(g)}`],switchBase:["switchBase",`color${S(k)}`,u&&"checked",v&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},x=Ie(C,He,a);return B({},a,x)},Ve=q("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,n.edge&&a[`edge${S(n.edge)}`],a[`size${S(n.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${d.thumb}`]:{width:16,height:16},[`& .${d.switchBase}`]:{padding:4,[`&.${d.checked}`]:{transform:"translateX(16px)"}}}}]}),Ze=q(Le,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.switchBase,{[`& .${d.input}`]:a.input},n.color!=="default"&&a[`color${S(n.color)}`]]}})(({theme:s})=>({position:"absolute",top:0,left:0,zIndex:1,color:s.vars?s.vars.palette.Switch.defaultColor:`${s.palette.mode==="light"?s.palette.common.white:s.palette.grey[300]}`,transition:s.transitions.create(["left","transform"],{duration:s.transitions.duration.shortest}),[`&.${d.checked}`]:{transform:"translateX(20px)"},[`&.${d.disabled}`]:{color:s.vars?s.vars.palette.Switch.defaultDisabledColor:`${s.palette.mode==="light"?s.palette.grey[100]:s.palette.grey[600]}`},[`&.${d.checked} + .${d.track}`]:{opacity:.5},[`&.${d.disabled} + .${d.track}`]:{opacity:s.vars?s.vars.opacity.switchTrackDisabled:`${s.palette.mode==="light"?.12:.2}`},[`& .${d.input}`]:{left:"-100%",width:"300%"}}),({theme:s})=>({"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.activeChannel} / ${s.vars.palette.action.hoverOpacity})`:F.alpha(s.palette.action.active,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(s.palette).filter(([,a])=>a.main&&a.light).map(([a])=>({props:{color:a},style:{[`&.${d.checked}`]:{color:(s.vars||s).palette[a].main,"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:F.alpha(s.palette[a].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${d.disabled}`]:{color:s.vars?s.vars.palette.Switch[`${a}DisabledColor`]:`${s.palette.mode==="light"?F.lighten(s.palette[a].main,.62):F.darken(s.palette[a].main,.55)}`}},[`&.${d.checked} + .${d.track}`]:{backgroundColor:(s.vars||s).palette[a].main}}}))]})),Xe=q("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(s,a)=>a.track})(({theme:s})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:s.transitions.create(["opacity","background-color"],{duration:s.transitions.duration.shortest}),backgroundColor:s.vars?s.vars.palette.common.onBackground:`${s.palette.mode==="light"?s.palette.common.black:s.palette.common.white}`,opacity:s.vars?s.vars.opacity.switchTrack:`${s.palette.mode==="light"?.38:.3}`})),Ke=q("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(s,a)=>a.thumb})(({theme:s})=>({boxShadow:(s.vars||s).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Ye=i.forwardRef(function(a,n){const g=We({props:a,name:"MuiSwitch"}),{className:k,color:u="primary",edge:v=!1,size:C="medium",sx:x}=g,D=De(g,Ge),h=B({},g,{color:u,edge:v,size:C}),c=Je(h),m=e.jsx(Ke,{className:c.thumb,ownerState:h});return e.jsxs(Ve,{className:Ne(c.root,k),sx:x,ownerState:h,children:[e.jsx(Ze,B({type:"checkbox",icon:m,checkedIcon:m,ref:n,ownerState:h},D,{classes:B({},c,{root:c.switchBase})})),e.jsx(Xe,{className:c.track,ownerState:h})]})});var R={},je;function Qe(){if(je)return R;je=1;var s=ee();Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var a=s(ae()),n=se();return R.default=(0,a.default)((0,n.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),R}var es=Qe();const ss=te(es);var E={},ve;function ts(){if(ve)return E;ve=1;var s=ee();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var a=s(ae()),n=se();return E.default=(0,a.default)((0,n.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2m6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5z"}),"NotificationsNone"),E}var as=ts();const rs=te(as);var W={},ye;function os(){if(ye)return W;ye=1;var s=ee();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var a=s(ae()),n=se();return W.default=(0,a.default)([(0,n.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07 1.95-1.95 5.12-1.95 7.07 0 1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy"),W}var is=os();const ns=te(is),ls=[{key:"account",icon:e.jsx(_e,{sx:{fontSize:28}}),title:"Account",subtitle:"Settings related to your personal information and account credentials"},{key:"notifications",icon:e.jsx(rs,{sx:{fontSize:28}}),title:"Notifications",subtitle:"All settings related to notifications"},{key:"workspace",icon:e.jsx(Fe,{sx:{fontSize:28}}),title:"Workspace",subtitle:"Manage your workspace settings and preferences"},{key:"privacy",icon:e.jsx(ns,{sx:{fontSize:28}}),title:"Privacy policy",subtitle:"All settings related to privacy"}],Se=[{label:"Pause notification",key:"pause"},{label:"In app",key:"inapp"},{label:"Email",key:"email"},{label:"SMS",key:"sms"},{label:"WhatsApp",key:"whatsapp"}],cs=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Europe/Berlin","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"],ds=["en-US","en-GB","es-ES","fr-FR","de-DE","it-IT","pt-BR","ja-JP","zh-CN","ko-KR"],us=()=>{const s=JSON.parse(localStorage.getItem("user")||"{}"),[a,n]=i.useState("account"),[g,k]=i.useState({pause:!1,inapp:!0,email:!0,sms:!0,whatsapp:!0}),[u,v]=i.useState(null),[C,x]=i.useState(!1),[D,h]=i.useState(""),[c,m]=i.useState(null),[L,U]=i.useState(""),[H,re]=i.useState(!1),[ke,N]=i.useState(!1),[y,oe]=i.useState(!1),[ie,b]=i.useState(""),[ne,I]=i.useState(""),[M,G]=i.useState(""),[w,J]=i.useState(""),[T,V]=i.useState(""),[Ce,le]=i.useState(!1),[p,P]=i.useState(null),[Z,_]=i.useState(!0),[X,z]=i.useState("");i.useEffect(()=>{if(a!=="account")return;x(!0),h(""),O("http://localhost:3000/api/users/me").then(async l=>{if(!l.ok)throw new Error("Failed to fetch profile");const f=await l.json();v(f.data.user)}).catch(()=>h("Failed to load profile")).finally(()=>x(!1))},[a]),i.useEffect(()=>{a==="workspace"&&(_(!0),z(""),Be().then(t=>{P(t)}).catch(()=>z("Failed to load workspace settings")).finally(()=>_(!1)))},[a]);const Pe=(t,l)=>{m(t),U(l||"")},ze=async()=>{if(c){re(!0);try{const t="http://localhost:3000";if(!(await O(`${t}/api/users/me`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[c]:L})})).ok)throw new Error("Failed to update");m(null),U(""),x(!0),h("");const K=await(await O(`${t}/api/users/me`)).json();v(K.data.user)}catch{}finally{re(!1),x(!1)}}},$e=async()=>{if(!M.trim()||!w.trim()||!T.trim()){b("All fields are required");return}if(w!==T){b("New passwords do not match");return}if(w.length<8){b("New password must be at least 8 characters long");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/.test(w)){b("Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character");return}oe(!0),b(""),I("");try{const f=await O("http://localhost:3000/api/users/me/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:M.trim(),newPassword:w.trim()})});if(!f.ok){const K=await f.json();throw new Error(K.error||"Failed to change password")}I("Password changed successfully!"),G(""),J(""),V(""),setTimeout(()=>{N(!1),I("")},2e3)}catch(l){b(l instanceof Error?l.message:"Failed to change password")}finally{oe(!1)}},Ae=async t=>{_(!0),z("");try{p&&(await qe(p.id,{name:t.name,timezone:t.timezone,locale:t.locale}),P(t),z("Workspace settings updated successfully!"))}catch(l){z(l instanceof Error?l.message:"Failed to update workspace")}finally{_(!1)}};return e.jsxs(o,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f8f9fa"},children:[e.jsx(o,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(de,{userRole:s.role,currentTab:"settings",onSignOut:ce})}),e.jsx(Te,{open:Ce,onClose:()=>le(!1),PaperProps:{sx:{width:240}},children:e.jsx(de,{userRole:s.role,currentTab:"settings",onSignOut:ce,isDrawer:!0})}),e.jsxs(o,{sx:{flex:1,ml:{xs:0,md:"220px"},display:"flex",flexDirection:"column",minHeight:"100vh",bgcolor:"#f8f9fa",px:pe.pagePx,py:pe.pagePy},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:[e.jsx(r,{variant:"h5",sx:{fontWeight:Y.title.weight,color:Oe.textPrimary,fontSize:{xs:Y.title.xs,md:Y.title.md}},children:"Settings"}),e.jsx(j,{variant:"outlined",color:"primary",onClick:()=>le(!0),children:e.jsx(ss,{})})]}),e.jsxs(o,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",md:"row"},minHeight:"calc(100vh - 64px)",bgcolor:"#f8f9fa"},children:[e.jsx(o,{sx:{width:{xs:"100%",md:320},bgcolor:"#fff",borderRight:{xs:"none",md:"1px solid #e0e0e0"},py:4,px:0,display:{xs:"none",md:"flex"},flexDirection:"column",minHeight:"100%"},children:ls.map(t=>e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:2,px:4,py:2.5,cursor:"pointer",bgcolor:a===t.key?"#E8ECF2":"transparent",borderRight:a===t.key?"4px solid #2950DA":"4px solid transparent",mb:.5,borderRadius:0,transition:"background 0.2s",minHeight:72},onClick:()=>n(t.key),children:[e.jsx(o,{sx:{color:a===t.key?"#2950DA":"#222",mt:.5},children:t.icon}),e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:800,fontSize:19,color:a===t.key?"#2950DA":"#222",mb:.2},children:t.title}),e.jsx(r,{sx:{color:"#6b7280",fontWeight:400,fontSize:14},children:t.subtitle})]})]},t.key))}),e.jsxs(o,{sx:{flex:1,p:0,bgcolor:"#f7f8fa",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",minHeight:"100vh"},children:[a==="notifications"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Notifications"}),e.jsx(Q,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:Se.map((t,l)=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:l===Se.length-1?0:2},children:[e.jsx(r,{sx:{fontWeight:500,fontSize:18,color:"#222"},children:t.label}),e.jsx(Ye,{checked:g[t.key],onChange:()=>k(f=>({...f,[t.key]:!f[t.key]})),color:"success"})]},t.key))})]}),a==="account"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Account"}),e.jsx(Q,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:C?e.jsx(r,{children:"Loading..."}):D?e.jsx(r,{color:"error",children:D}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Legal name"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(u==null?void 0:u.name)||"N/A"})]}),e.jsx(r,{sx:{color:"#2950DA",fontWeight:700,fontSize:15,cursor:"pointer"},onClick:()=>Pe("name",(u==null?void 0:u.name)||""),children:"Edit"})]}),e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Email address"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(u==null?void 0:u.email)||"N/A"})]})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Password"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:"••••••••"})]}),e.jsx(j,{variant:"outlined",color:"primary",onClick:()=>{N(!0),b(""),I(""),G(""),J(""),V("")},children:"Change Password"})]})]})}),e.jsxs(he,{open:!!c,onClose:()=>m(null),children:[e.jsxs(xe,{children:["Edit"," ",c==="name"?"Legal name":c==="email"?"Email address":c==="address"?"Address":c==="phone"?"Phone number":"Government ID"]}),e.jsx(fe,{children:e.jsx($,{autoFocus:!0,margin:"dense",label:c==="name"?"Legal name":c==="email"?"Email address":c==="address"?"Address":c==="phone"?"Phone number":"Government ID",type:"text",fullWidth:!0,value:L,onChange:t=>U(t.target.value)})}),e.jsxs(ge,{children:[e.jsx(j,{onClick:()=>m(null),disabled:H,children:"Cancel"}),e.jsx(j,{onClick:ze,variant:"contained",color:"primary",disabled:H||!L.trim(),children:H?"Saving...":"Save"})]})]})]}),a==="workspace"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Workspace Settings"}),e.jsx(Q,{elevation:0,sx:{width:{xs:"100%",sm:600},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:Z?e.jsx(o,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(Me,{})}):X?e.jsx(Ue,{severity:X.includes("successfully")?"success":"error",sx:{mb:3},children:X}):p?e.jsx(o,{children:e.jsxs(A,{container:!0,spacing:3,children:[e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsx($,{fullWidth:!0,label:"Workspace Name",value:p.name,onChange:t=>{const l={...p,name:t.target.value};P(l)},sx:{mb:2}})}),e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsxs(me,{fullWidth:!0,sx:{mb:2},children:[e.jsx(be,{children:"Timezone"}),e.jsx(we,{value:p.timezone,label:"Timezone",onChange:t=>{const l={...p,timezone:t.target.value};P(l)},children:cs.map(t=>e.jsx(ue,{value:t,children:t},t))})]})}),e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsxs(me,{fullWidth:!0,sx:{mb:2},children:[e.jsx(be,{children:"Locale"}),e.jsx(we,{value:p.locale,label:"Locale",onChange:t=>{const l={...p,locale:t.target.value};P(l)},children:ds.map(t=>e.jsx(ue,{value:t,children:t},t))})]})}),e.jsx(A,{item:!0,xs:12,children:e.jsx(j,{variant:"contained",color:"primary",onClick:()=>Ae(p),disabled:Z,sx:{mt:2},children:Z?"Saving...":"Save Changes"})})]})}):e.jsx(r,{color:"error",children:"No workspace data available"})})]}),a==="privacy"&&e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:2},children:"Privacy Policy"})]})]})]}),e.jsxs(he,{open:ke,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(xe,{children:"Change Password"}),e.jsxs(fe,{children:[ne?e.jsx(r,{color:"success.main",sx:{mb:2},children:ne}):null,ie?e.jsx(r,{color:"error.main",sx:{mb:2},children:ie}):null,e.jsxs(o,{sx:{bgcolor:"#f8f9fa",p:2,borderRadius:1,mb:2,border:"1px solid #e9ecef"},children:[e.jsx(r,{sx:{fontWeight:600,fontSize:14,color:"#495057",mb:1},children:"Password Requirements:"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• Minimum 8 characters"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 uppercase letter (A-Z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 lowercase letter (a-z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 number (0-9)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 special character (@$!%*?&)"})]})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx($,{label:"Current Password",type:"password",fullWidth:!0,value:M,onChange:t=>G(t.target.value),disabled:y}),e.jsx($,{label:"New Password",type:"password",fullWidth:!0,value:w,onChange:t=>J(t.target.value),disabled:y,helperText:"Minimum 8 characters, 1 uppercase, 1 lowercase, 1 number, and 1 special character"}),e.jsx($,{label:"Confirm New Password",type:"password",fullWidth:!0,value:T,onChange:t=>V(t.target.value),disabled:y})]})]}),e.jsxs(ge,{children:[e.jsx(j,{onClick:()=>N(!1),disabled:y,children:"Cancel"}),e.jsx(j,{variant:"contained",color:"primary",disabled:y||!M.trim()||!w.trim()||!T.trim(),onClick:$e,children:y?"Changing Password...":"Change Password"})]})]})]})},ks=Object.freeze(Object.defineProperty({__proto__:null,default:us},Symbol.toStringTag,{value:"Module"}));export{ss as M,us as S,ks as a};
