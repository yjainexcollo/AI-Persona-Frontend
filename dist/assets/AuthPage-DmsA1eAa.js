import{f as C,G as R,h as O,i as q,r as u,k as T,l as E,j as e,B as f,T as b,H as _}from"./index-TH8YGKRz.js";import{V as L,a as D}from"./Visibility-B8j3ksI8.js";import{r as M}from"./createSvgIcon-B0Pm_6cI.js";import{A as S}from"./Alert-DkG2QiTi.js";import{T as I}from"./TextField-Du34Z7EL.js";import{I as z}from"./InputAdornment-Cgg0GFqY.js";import{I as y}from"./IconButton-BAp8iDOQ.js";import{B as v}from"./Button-CJZqiG46.js";import"./createSvgIcon-1GfyKPJS.js";import"./useControlled-BLQOo7Av.js";import"./useSlot-B20WKvL2.js";import"./resolveComponentProps-CAz9EWAT.js";import"./Paper-Mdtt8qvf.js";import"./Menu-CzX3FVwN.js";var m={},W;function N(){if(W)return m;W=1;var h=C();Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0,g(R());var j=h(M()),l=O();function x(t){if(typeof WeakMap!="function")return null;var c=new WeakMap,a=new WeakMap;return(x=function(s){return s?a:c})(t)}function g(t,c){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var a=x(c);if(a&&a.has(t))return a.get(t);var s={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)){var i=w?Object.getOwnPropertyDescriptor(t,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=t[n]}return s.default=t,a&&a.set(t,s),s}return m.default=(0,j.default)((0,l.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"}),"Apple"),m}var B=N();const F=q(B),G=()=>{const[h,j]=u.useState(!1),[l,x]=u.useState({email:"",password:""}),[g,t]=u.useState(""),[c,a]=u.useState(""),[s,w]=u.useState(!1),n=T(),i=E();u.useEffect(()=>{var d;const o=(d=i.state)==null?void 0:d.message;o&&a(o)},[i]);const k=o=>{x({...l,[o.target.name]:o.target.value})},P=async o=>{o.preventDefault(),t(""),w(!0);try{const p=await fetch("http://localhost:3000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),r=await p.json();if(!p.ok)throw p.status===403&&r.error&&r.error.includes("Email not verified")?new Error("Your email is not verified. Please check your inbox and verify your account before logging in."):p.status===401&&r.error&&r.error.includes("Invalid email or password")?new Error("Wrong password. Please check your password and try again."):p.status===423&&r.error&&r.error.includes("Account is temporarily locked")?new Error("Account is temporarily locked due to too many failed attempts. Please wait 15 minutes before trying again."):new Error(r.error||"Login failed");localStorage.setItem("token",r.data.accessToken),localStorage.setItem("user",JSON.stringify(r.data.user)),r.data.refreshToken&&localStorage.setItem("refreshToken",r.data.refreshToken),r.data.workspaceId&&localStorage.setItem("workspaceId",r.data.workspaceId),r.data.workspaceName&&localStorage.setItem("workspaceName",r.data.workspaceName),_(),n("/",{replace:!0})}catch(d){t(d instanceof Error?d.message:"Login failed")}finally{w(!1)}},A=()=>{const o="http://localhost:3000";window.location.href=`${o}/api/auth/google`};return e.jsx(f,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#fff",justifyContent:"center",alignItems:"center",pt:{xs:6,sm:8},px:{xs:2,sm:3}},children:e.jsx(f,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",px:{xs:2,sm:4},maxWidth:{xs:420,sm:480},width:"100%"},children:e.jsxs(f,{component:"form",onSubmit:P,sx:{width:"100%",maxWidth:{xs:360,sm:370}},children:[e.jsx(b,{variant:"h5",sx:{fontWeight:800,mb:{xs:3,sm:4},color:"#222",textAlign:{xs:"center",sm:"left"}},children:"Log in"}),c&&e.jsx(S,{severity:"success",sx:{mb:2},children:c}),g&&e.jsx(S,{severity:"error",sx:{mb:2},children:g}),e.jsx(b,{sx:{fontWeight:700,fontSize:14,mb:1,color:"#222"},children:"Email"}),e.jsx(I,{fullWidth:!0,name:"email",type:"email",placeholder:"Your email",variant:"outlined",value:l.email,onChange:k,required:!0,sx:{mb:{xs:1.5,sm:2},borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2,height:{xs:44,sm:48}}}}),e.jsx(b,{sx:{fontWeight:700,fontSize:14,mb:1,color:"#222"},children:"Password"}),e.jsx(I,{fullWidth:!0,name:"password",placeholder:"Your password",variant:"outlined",type:h?"text":"password",value:l.password,onChange:k,required:!0,sx:{mb:1,borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2,height:{xs:44,sm:48}}},InputProps:{endAdornment:e.jsx(z,{position:"end",children:e.jsx(y,{onClick:()=>j(o=>!o),edge:"end",children:h?e.jsx(L,{}):e.jsx(D,{})})})}}),e.jsx(f,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:e.jsx(v,{sx:{color:"#526794",fontWeight:600,fontSize:14,textTransform:"none",p:0,minWidth:0},onClick:()=>n("/forgot-password"),children:"Forgot Password?"})}),e.jsx(v,{type:"submit",variant:"contained",fullWidth:!0,disabled:s,sx:{bgcolor:"#526794",color:"#fff",fontWeight:700,fontSize:{xs:16,sm:18},borderRadius:2,py:{xs:1.25,sm:1.5},mb:3,boxShadow:"none",textTransform:"none","&:hover":{bgcolor:"#526794"}},children:s?"Logging in...":"Log in"}),e.jsxs(f,{sx:{display:"flex",justifyContent:"center",gap:2,mb:3},children:[e.jsx(y,{sx:{p:1},onClick:A,"aria-label":"Sign in with Google",children:e.jsx(f,{component:"img",src:"https://th.bing.com/th?q=Google+Login+Logo.png&w=120&h=120&c=1&rs=1&qlt=70&o=7&cb=1&dpr=1.5&pid=InlineBlock&rm=3&mkt=en-IN&cc=IN&setlang=en&adlt=moderate&t=1&mw=247",alt:"Google",sx:{width:26,height:26,objectFit:"contain"}})}),e.jsx(y,{sx:{p:1},"aria-label":"Sign in with Apple",children:e.jsx(F,{sx:{fontSize:28,color:"#222"}})})]}),e.jsxs(b,{sx:{textAlign:"center",color:"#444",fontWeight:500,fontSize:{xs:14,sm:16},mt:1},children:["Don't have an account?"," ",e.jsx(v,{sx:{color:"#1a237e",fontWeight:700,fontSize:{xs:14,sm:16},textTransform:"none",p:0,minWidth:0},onClick:()=>n("/register"),children:"Register"})]})]})})})},se=()=>e.jsx(G,{});export{se as default};
